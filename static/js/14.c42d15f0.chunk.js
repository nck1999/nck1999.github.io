(this["webpackJsonpback-to-basic"]=this["webpackJsonpback-to-basic"]||[]).push([[14],{484:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,a,c=n(3),i=(n(0),n(56)),o=n(4),s=n.p+"static/media/back.7bf7a56f.svg",u=n(1),b=function(e){var t=e.name,n=e.backPath;return Object(u.jsxs)(l,{children:[n&&Object(u.jsx)(i.b,{to:n,children:Object(u.jsx)(d,{src:s})}),t]})},d=o.b.img(r||(r=Object(c.a)(["\n  height: 20px;\n  top: 14px;\n  left: 16px;\n  position: absolute;\n"]))),l=o.b.div(a||(a=Object(c.a)(["\n  color: #ffffff;\n  background-color: #12b188;\n  text-align: center;\n  line-height: 48px;\n  text-shadow: 0px 1px 2px rgba(0, 0, 0, 0.8);\n  flex-shrink: 0;\n"])))},497:function(e,t,n){"use strict";n.d(t,"a",(function(){return V}));var r,a=n(3),c=n(122),i=n.n(c),o=n(162),s=n(6),u=n(661),b=n(630),d=n(631),l=n(632),j=n(633),f=n(562),p=n(0),h=n(169),O=n(446),g=n(56),v=n(629),x=n(4),m=n(164);!function(e){e.GET_USER_MEDIA_NOT_FOUND="GET_USER_MEDIA_NOT_FOUND",e.CAMERA_ACTIVATE_ERROR="CAMERA_ACTIVATE_ERROR"}(r||(r={}));var E,A,_=function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("mediaDevices"in navigator)){e.next=11;break}return e.prev=1,e.abrupt("return",navigator.mediaDevices.getUserMedia({video:t?{deviceId:t}:{facingMode:"environment"},audio:!1}));case 5:throw e.prev=5,e.t0=e.catch(1),console.error(e.t0),new Error(r.CAMERA_ACTIVATE_ERROR);case 9:e.next=12;break;case 11:throw new Error(r.GET_USER_MEDIA_NOT_FOUND);case 12:case"end":return e.stop()}}),e,null,[[1,5]])})));return function(t){return e.apply(this,arguments)}}(),k=n(1),V=function(e){var t=e.onFrame,n=e.suppressError,a=void 0!==n&&n,c=Object(O.a)("qr_reader").t,x=Object(m.b)().preferredCameraId,E=Object(p.useState)(!1),A=Object(s.a)(E,2),V=A[0],w=A[1],N=Object(p.useState)(!1),D=Object(s.a)(N,2),R=D[0],y=D[1],I=Object(p.useRef)(null),S=Object(p.useRef)(null),M=Object(v.a)((function(){var e=S.current,n=I.current;if(e&&n&&n.readyState===n.HAVE_ENOUGH_DATA){var r=e.getContext("2d");if(!r)return;e.height=n.videoHeight,e.width=n.videoWidth,r.drawImage(n,0,0,e.width,e.height);var a=r.getImageData(0,0,e.width,e.height);t&&t(a)}}),!1),U=Object(s.a)(M,2),F=U[0],Q=U[1],z=Object(p.useCallback)(Object(o.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=I.current){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,_("AUTO"===x?void 0:x);case 6:if(n=e.sent){e.next=9;break}return e.abrupt("return");case 9:t.srcObject=n,t.play(),Q(),e.next=26;break;case 14:e.prev=14,e.t0=e.catch(3),e.t1=e.t0.message,e.next=e.t1===r.GET_USER_MEDIA_NOT_FOUND?19:e.t1===r.CAMERA_ACTIVATE_ERROR?21:25;break;case 19:return w(!0),e.abrupt("break",26);case 21:if(!a){e.next=23;break}return e.abrupt("return");case 23:return y(!0),e.abrupt("break",26);case 25:console.error(e.t0);case 26:case"end":return e.stop()}}),e,null,[[3,14]])}))),[Q,x,a]);return Object(p.useEffect)((function(){var e=I.current;return z(),function(){if(F(),e){var t=e.srcObject;if(!t)return;t.getTracks().forEach((function(e){e.stop()})),e.srcObject=null}}}),[Q,F,I,z,x]),Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(C,{ref:I,playsInline:!0}),Object(k.jsx)(T,{ref:S}),Object(k.jsxs)(u.a,{open:V,keepMounted:!0,"aria-labelledby":"unsupported-device-title","aria-describedby":"unsupported-device-description",children:[Object(k.jsx)(b.a,{id:"unsupported-device-title",children:"\u4e0d\u652f\u63f4\u7684\u88dd\u7f6e"}),Object(k.jsx)(d.a,{children:Object(k.jsxs)(l.a,{id:"unsupported-device-description",children:[c("message.doesnt_support_get_user_media"),h.isIOS&&Object(k.jsx)(k.Fragment,{children:c("message.sure_above_ios_14")})]})}),Object(k.jsx)(j.a,{children:Object(k.jsx)(g.b,{to:"/",children:Object(k.jsx)(f.a,{color:"primary",children:c("button.back_home")})})})]}),Object(k.jsxs)(u.a,{open:R,keepMounted:!0,"aria-labelledby":"camera-activation-title","aria-describedby":"camera-activation-description",children:[Object(k.jsx)(b.a,{id:"camera-activation-title",children:c("dialog.cannot_open_camera.title")}),Object(k.jsx)(d.a,{children:Object(k.jsx)(l.a,{id:"camera-activation-description",children:c("dialog.cannot_open_camera.content")})}),Object(k.jsxs)(j.a,{children:[Object(k.jsx)(g.b,{to:"/",children:Object(k.jsx)(f.a,{color:"primary",children:c("button.back_home")})}),Object(k.jsx)(g.b,{to:"/cameraSetting",children:Object(k.jsx)(f.a,{color:"primary",children:c("button.camera_setting")})})]})]})]})},C=x.b.video(E||(E=Object(a.a)(["\n  /* Make video to at least 100% wide and tall */\n  min-width: 100%;\n  min-height: 100%;\n\n  /* Setting width & height to auto prevents the browser from stretching or squishing the video */\n  width: auto;\n  height: auto;\n\n  /* Center the video */\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n"]))),T=x.b.canvas(A||(A=Object(a.a)(["\n  display: none;\n"])))},501:function(e,t,n){"use strict";t.a=n.p+"static/media/qrOverlay.185cc3ea.svg"},502:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(521),a=n.n(r),c=n(0),i=n(497),o=n(1),s=function(e){var t=e.onDecode,n=Object(c.useCallback)((function(e){var n=a()(e.data,e.width,e.height);n&&t(n)}),[t]);return Object(o.jsx)(i.a,{onFrame:n})}},660:function(e,t,n){"use strict";n.r(t);var r,a=n(3),c=n(122),i=n.n(c),o=n(162),s=n(6),u=n(84),b=n(0),d=n(446),l=n(602),j=n.n(l),f=n(4),p=n(501),h=n(484),O=n(502),g=n(651),v=n(652),x=n(653),m=n(662),E=n(603),A=n.n(E),_=function(e,t,n){return new A.a(t,"spki").createVerify("SHA256").update(e).verify(n,"base64")};!function(e){e.UNKNOWN="UNKNOWN",e.EVT1="EVT1",e.EVT1_1="EVT1_1",e.VAC2="VAC2",e.VAC3="VAC3",e.VAC4="VAC4"}(r||(r={}));var k,V,C,T,w,N=function(){var e=Object(o.a)(i.a.mark((function e(t){var n,r,a,c,o,s,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=Object(g.a)("|",t),console.log("input:",n),!(n.length<3)){e.next=5;break}return e.abrupt("return",null);case 5:if(r=I(n),console.log("CODE_SCANNER","parseResult: ",r),r){e.next=9;break}return e.abrupt("return",null);case 9:return a=r.schemaVersion,c=r.digitalSignature,o=r.stringToBeSigned,s=D(a)||c,console.log("CODE_SCANNER","digitalSignature: "+c),console.log("CODE_SCANNER","stringToBeSigned: "+o),console.log("CODE_SCANNER","publicKey: "+s),e.next=16,_(o,s,c);case 16:if(u=e.sent,console.log("CODE_SCANNER","validationPass: "+u),u){e.next=20;break}return e.abrupt("return",null);case 20:return e.abrupt("return",r);case 23:return e.prev=23,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",null);case 27:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t){return e.apply(this,arguments)}}(),D=function(e){switch(e){case r.EVT1:case r.EVT1_1:case r.VAC2:return"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAErPNELrvyZHvKtCcwIjBRsWItljAosuGsBEG+AjNY0PztjCQffvGm/b38JvXsccFa1s3JVN9id2dXFqxjJ9OtTQ==";case r.VAC3:return"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEOBxm8jQVg9VN5yGUj7bkvsor73k4r1AvNs2EoXiDYVVQCChFkDKhASMIaqMSbf5H73ub8WT3A+3mn/mnZPqbtQ==";case r.VAC4:return"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAErO8N4+4Z18Fj2Qeo/w90ybG79YaZzY5AJlOIUn7TtVXuNNTo85f5ofhk5saORUPtrijnENgyxoBkzJyL9UXadQ==";default:return null}},R=function(e,t){var n=Object(s.a)(t,11);return{prefix1:n[0],prefix2:n[1],formatVersion:n[2],refId:n[3],docType:n[4],iNum:n[5],specimenCollectionDate:n[6],specimenType:n[7],testingPlatform:n[8],testResult:n[9],reportDate:n[10],downloadDate:e===r.EVT1?null:t[11],digitalSignature:e===r.EVT1?t[11]:t[12],stringToBeSigned:Object(v.a)("|",Object(x.a)(t))+"|",schemaVersion:e}},y=function(e,t){var n=Object(s.a)(t,19);return{prefix1:n[0],prefix2:n[1],qrCodeVersion:n[2],keyVersion:n[3],vacRef:n[4],iNum:n[5],label1:n[6],firstDoseDate:n[7],firstVaccineName:n[8],firstVaccineNameTc:n[9],firstBrandName:n[10],firstBrandNameTc:n[11],secondDoseDate:n[12],secondVaccineName:n[13],secondVaccineNameTc:n[14],secondBrandName:n[15],secondBrandNameTc:n[16],downloadDate:n[17],digitalSignature:n[18],stringToBeSigned:Object(v.a)("|",Object(x.a)(t))+"|",schemaVersion:e}},I=function(e){return"EVT"===e[1]&&12===e.length?R(r.EVT1,e):"EVT"===e[1]&&13===e.length?R(r.EVT1_1,e):"VAC"===e[1]&&Object(m.a)("2",e[2])?y(r.VAC2,e):"VAC"===e[1]&&Object(m.a)("3",e[2])?y(r.VAC3,e):"VAC"===e[1]&&Object(m.a)("4",e[2])?y(r.VAC4,e):null},S=n(1),M=(t.default=function(){var e=Object(d.a)("vaccination_qr_reader").t,t=Object(b.useState)(null),n=Object(s.a)(t,2),r=n[0],a=n[1],c=function(){var e=Object(o.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=t.data)&&!Object(u.a)(n)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,N(n);case 5:if(r=e.sent){e.next=8;break}return e.abrupt("return");case 8:console.log(n,r),a(r);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(S.jsxs)(M,{children:[Object(S.jsx)(h.a,{backPath:"/",name:e("name")}),Object(S.jsx)(Q,{children:e("message.scan_qr_code")}),Object(S.jsxs)(U,{children:[r&&Object(S.jsx)(z,{children:Object(S.jsx)(j.a,{src:r})}),Object(S.jsx)(F,{}),Object(S.jsx)(O.a,{onDecode:c})]})]})},f.b.div(k||(k=Object(a.a)(["\n  width: 100%;\n  height: 100%;\n  text-shadow: 0px 1px 2px rgba(0, 0, 0, 0.8);\n  display: flex;\n  flex-direction: column;\n"])))),U=f.b.div(V||(V=Object(a.a)(["\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: relative;\n"]))),F=f.b.div(C||(C=Object(a.a)(['\n  /* The image used */\n  background-image: url("','");\n\n  /* Full height */\n  height: 100%;\n\n  /* Center and scale the image nicely */\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: cover;\n\n  z-index: 50;\n  position: relative;\n'])),p.a),Q=f.b.div(T||(T=Object(a.a)(["\n  position: absolute;\n  z-index: 51;\n  bottom: 20%;\n  width: 100%;\n  text-align: center;\n  color: #ffffff;\n  font-size: 16px;\n"]))),z=f.b.div(w||(w=Object(a.a)(["\n  background-color: #ffffff;\n  position: fixed;\n  bottom: 0;\n  width: 100%;\n  z-index: 100;\n  text-shadow: unset;\n"])))}}]);
//# sourceMappingURL=14.c42d15f0.chunk.js.map